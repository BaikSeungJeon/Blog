## TIL 2022 10 27

### 쿠키 vs 세션 vs 웹 스토리지

#### 인증

> HTTP를 통해 api 요청에 대해 사용자의 권한 확인 및 접근을 제한하는 역할

쿠키와 세션, 웹 스토리지가 무엇인지 알기 전에 인증에 대해서도 알아봤습니다. 이러한 인증이 필요한 이유는, 현재 웹과 앱 서비스에서 가장 많이 쓰이는 통신 방식인 HTTP 통신은 
응답 후 연결을 끊고 과거에 대한 정보를 전혀 담지 않았습니다. 이 말인 즉슨 지금 보낼 HTTP 요청은 지난 번 HTTP 요청과 전혀 관계가 없다는 것이고,
각각의 HTTP 요청에는 주체가 누구인지에 대한 정보가 필수가 되어버린 것이죠.

그리고 이러한 인증의 수단들이 다음과 같습니다.

#### 쿠키

> 웹 브라우저에 쿠키를 저장하여 HTTP 요청 시 쿠키를 헤더에 추가해서 보내는 방식

<img width="582" alt="image" src="https://user-images.githubusercontent.com/85447054/198184464-d932b72a-1c75-4258-a17b-49dd344148e4.png">

쿠키는 위의 그림과 같은 흐름으로 사용됩니다. 쿠키를 사용하는 이유는 HTTP 요청은 상태를 가지고 있지 않기 때문인데요.(Stateless) 다시 말해 브라우저에서는 서버에 요청을 보낼 때 그 요청 자체로는
그 요청이 누구에게서 오는지 알 수가 없는데 쿠키에 정보를 담아서 보낸다면 서버는 쿠키를 통해 파악할 수 있게 됩니다.

예를 들어 과거에는 쇼핑몰에서 로그인을 해야 장바구니에 정보가 저장되었다면, 요즘의 쇼핑몰은 로그인을 하지 않은 상태에서도 일정 기간 쿠키를 통해 정보를 유지할 수 있게 되었다는 것입니다.
쿠키는 주로 세션 관리를 통해 **로그인과 일정 접속 시간의 장바구니 등에 활용**되기도 하고, 쿠키를 통해 **사용자 별로 다른 정보를 표시**하는 등 <code>개인화</code>가 가능하며,
사용자의 행동과 패턴을 분석할 수 있기 때문에 요즘에는 더 중요한 개념이 되었습니다.

쿠키를 사용하기 위해서는 <code>Set-Cookie:키=값</code> 옵션을 사용합니다. 이것은 서버에서 클라이언트한테 **쿠키를 저장하라고 요청하는 것**입니다.
만약에 <code>Set-Cookie:name=kante</code>면 <code>name</code>이라는 키에 <code>kante</code>라는 값을 저장해서 보내는 것입니다.

쿠키의 단점이라고 하면 장기간 유지되면서 브라우저 종료 후에도 유지되는 <code>Persistent Cookie</code>의 경우 사용자의 하드디스크에 저장됩니다.
이렇게 되면 공공 PC의 경우는 쿠키를 탈취하여 개인정보를 빼돌릴 가능성도 존재해 이러한 보안상 취약점이 있고, 네트워크를 통해 암호화되지 않는 쿠키를 전송할 때는 쿠키 정보를 탈취하는 스니핑 공격에도 당할 수 있는 등 대표적으로 보안상 취약점이 가장 큰 단점으로 뽑힙니다. 이 외에도 쿠키의 용량이 <code>약 4Kb</code>로 작거나 매 HTTP 요청마다 API 호출로 인한 서버의 부담을 꼽을 수 있습니다.

#### 세션

> Session ID를 식별자로, 데이터를 사용자 브라우저의 쿠키가 아닌 접속한 서버에 정보를 저장하는 방식

쿠키와 자주 비교되며 언급되는 인증 수단입니다. 세션의 경우 사용자가 접속 시 식별을 위한 <code>Session ID</code>를 생성하고 이를 메모리에 유저 정보와 함께 저장을 합니다. 그리고 이후 브라우저가 종료되면 사라지기 때문에, 쿠키의 보안상 취약점을 해결하고자 사용되었습니다.

하지만 서버에서 세션 저장소를 사용해 서버에 추가적인 저장 공간을 필요로 하기 때문에 **서버에 부하가 커진다는 단점**이 존재합니다.

- 사용자 정보를 파일 브라우저에 저장하는 쿠키와 달리 세션은 서버 측에서 관리한다.
- 서버에서 클라이언트를 구분하기 위해 세션 ID를 부여하며, 웹 브라우저가 서버에 접속해서 브라우저를 종료할 때까지 인증상태를 유지한다.
- 접속 시간에 제한을 두어 일정 시간 응답이 없다면 정보가 유지되지 않게 설정 가능하다.
- 데이터를 서버에 두기 때문에 쿠키보다 보안에 좋지만, 사용자가 많아질수록 서버 메모리를 많이 차지하게 된다.

#### 웹 스토리지

쿠키 단점 보완 > 웹 스토리지
웹 스토리지에는 로컬 스토리지와 세션 스토리지가 있다.
웹 스토리지는 key value로 이루어짐
웹 스토리지는 클라이언트에 정보를 저장
웹 스토리지는 로컬, 쿠키는 서버와 로컬에 저장

쿠키 장/단점
1. 대부분 브라우저가 지원

1. 매 http 요청에 포함되어 있어 api 호출로 서버에 부담
2. 용량 작음 (4kb)
3. 보안에 취약

웹 스토리지 장/단점
1. 서버에 불필요한 영향 x
2. 용량이 크다(5mb)


쓰임새
자동 로그인 > 로컬
입력 폼 정보 > 세션
비로그인 장바구니 > 세션
다시 보지 않음 > 쿠키


### useMemo vs useCallback

#### useMemo

#### useCallback

### NVM

#### NVM이란?

#### NVM 설치

### 참고

[쿠키 vs 세션 vs 웹 스토리지](https://ykss.netlify.app/web/storage_session_cookie/)
